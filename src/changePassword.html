<!DOCTYPE html>
<html>
  <head>
    <script src="/js/connection.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/styles.css">
    <title>Cambiar Contraseña</title>
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  </head>

  <body>
    <div class="testbox">
      <div class="formulario">
        <div class="banner">
          <h1>Cambiar Contraseña</h1>
        </div>
        <br/>
        </p>
        <br/>
        <div class="">
          <div class="item">
            <label for="fname"> Contraseña actual<span>*</span></label>
            <input id="oldPassword" type="password" name="fname" required/>
          </div>
          <div class="item">
            <label for="fname"> Nueva contraseña<span>*</span></label>
            <input id="newPassword1" type="password" name="fname" required/>
          </div>
          <div class="item">
            <label for="fname"> Repita su nueva contraseña<span>*</span></label>
            <input id="newPassword2" type="password" name="fname" required/>
          </div>
        </div>
        <div class="btn-block">
          <button type="submit" onclick="changePassword()">Cambiar</button>
          <button type="submit" onclick="goBack()">Volver</button>
        </div>
    </div>
    </div>
  </body>
</html>
<script>
    //load the image of the banner
    var banner = document.getElementsByClassName("banner")[0];
    banner.style.backgroundImage = "url('../fondo.png')";

    function changePassword() {
      var oldPassword = document.getElementById("oldPassword").value;
      var newPassword1 = document.getElementById("newPassword1").value;
      var newPassword2 = document.getElementById("newPassword2").value;

      if (newPassword1 != newPassword2) {
        alert("Las contraseñas no coinciden");
        return;
      }

      if (newPassword1.length < 5) {
        alert("La contraseña debe tener al menos 5 caracteres");
        return;
      }

      if (!tieneMayuscula(newPassword1)) {
        alert("La contraseña debe tener al menos una letra mayúscula");
        return;
      }

      if (!tieneNumero(newPassword1)) {
        alert("La contraseña debe tener al menos un número");
        return;
      }
      //TODO: cambiar contraseña
      alert("Contraseña cambiada con éxito");
      window.location.href = "login.html";

    }
    
    function tieneMayuscula(palabra) {
      // Expresión regular para buscar al menos una letra mayúscula
      var regex = /[A-Z]/;
      return regex.test(palabra);
    }

    function tieneNumero(palabra) {
      // Expresión regular para buscar al menos un número
      var regex = /[0-9]/;
      return regex.test(palabra);
    }

</script>